import{g as M,E as p}from"./index-Cqqea-f1.js";const g="_window_1295y_1",z="_resizeHandle_1295y_12",C="_nw_1295y_19",k="_ne_1295y_24",B="_sw_1295y_29",N="_se_1295y_34",W="_n_1295y_19",L="_e_1295y_46",S="_s_1295y_29",$="_w_1295y_1",H="_titleBar_1295y_67",I="_windowControls_1295y_78",O="_controlButton_1295y_86",X="_close_1295y_104",Y="_minimize_1295y_113",R="_maximize_1295y_122",V="_title_1295y_67",q="_content_1295y_140",o={window:g,resizeHandle:z,nw:C,ne:k,sw:B,se:N,n:W,e:L,s:S,w:$,titleBar:H,windowControls:I,controlButton:O,close:X,minimize:Y,maximize:R,title:V,content:q};var u={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var E;function G(){return E||(E=1,function(h){(function(){var t={}.hasOwnProperty;function e(){for(var i="",n=0;n<arguments.length;n++){var r=arguments[n];r&&(i=a(i,d(r)))}return i}function d(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return e.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var n="";for(var r in i)t.call(i,r)&&i[r]&&(n=a(n,r));return n}function a(i,n){return n?i?i+" "+n:i+n:i}h.exports?(e.default=e,h.exports=e):window.classNames=e})()}(u)),u.exports}var A=G();const D=M(A),T="_window-container_11e4n_1",Z="_pointer-mask_11e4n_10",b={windowContainer:T,pointerMask:Z};class s extends p{static EventType={ON_WINDOW_CHANGE:Symbol("onWindowChange")};static _ins;static get ins(){return s._ins||(s._ins=new s)}static _id=0;static getNewId(){return`window_${s._id++}`}maxZIndex=1;windows=new Map;container=document.getElementById("window-container")||document.createElement("div");pointerMask=document.getElementById("pointer-mask")||document.createElement("div");_enableMask=!1;set enableMask(t){this._enableMask=t,this.pointerMask.style.display=t?"block":"none"}get enableMask(){return this._enableMask}constructor(){super(),document.body.appendChild(this.container),this.container.id="window-container",this.container.className=b.windowContainer,document.body.appendChild(this.pointerMask),this.pointerMask.id="pointer-mask",this.pointerMask.className=b.pointerMask,this.enableMask=!1}showWindow(t,e){const d=new w(t,e);return this.container.appendChild(d.body),this.emit(s.EventType.ON_WINDOW_CHANGE),d}closeWindow(t){this.unregisterWindow(t.id),t.body.remove(),t.destroy(),this.emit(s.EventType.ON_WINDOW_CHANGE)}getNextZIndex(){return++this.maxZIndex}registerWindow(t,e){this.windows.set(t,e)}unregisterWindow(t){this.windows.delete(t)}getWindows(){return this.windows}getWindow(t){return this.windows.get(t)}}class w extends p{static EventType={ON_CLOSE:Symbol("onWindowClose")};_isValid=!0;get isValid(){return this._isValid}id=s.getNewId();title="";_children=null;icon=null;set children(t){t!==this._children&&(this._children=t,this.children instanceof HTMLElement?this.content.appendChild(this.children):typeof this.children=="string"&&(this.content.innerText=this.children))}get children(){return this._children}x=0;y=0;width=0;height=0;prevX=0;prevY=0;prevWidth=0;prevHeight=0;isMaximized=!1;isMinimized=!1;body=document.createElement("div");titleBar=document.createElement("div");content=document.createElement("div");constructor(t,e){super();const{title:d="Window",x:a=100,y:i=100,width:n=250,height:r=600,icon:c}=e;this.title=d,this.icon=c,this.body.style.zIndex=String(s.ins.getNextZIndex()),this.body.className=o.window,this.createResizeHandle(),this.createTitleBar(),this.move(a,i),this.resize(n,r),this.content.className=o.content,this.body.appendChild(this.content),this.children=t,this.createForceEvent(),s.ins.registerWindow(this.id,this)}createResizeHandle(){["nw","ne","sw","se","n","s","w","e"].forEach(t=>{const e=document.createElement("div");e.className=D(o.resizeHandle,o[t]),e.addEventListener("pointerdown",d=>this.handleResizeStart(d,t)),this.body.appendChild(e)})}createTitleBar(){this.titleBar.innerHTML=`
            <div class=${o.titleBar}>
                <div class="${o.windowControls}">
                    <div class="${o.controlButton} ${o.close}"></div>
                    <div class="${o.controlButton} ${o.minimize}"></div>
                    <div class="${o.controlButton} ${o.maximize}"></div>
                </div>
                <span class="${o.title}">${this.title}</span>
            </div>
        `,this.titleBar.addEventListener("pointerdown",this.handleReadyMove),this.titleBar.addEventListener("dblclick",this.handleChangeMaximize),this.titleBar.querySelector(`.${o.close}`).addEventListener("click",this.handleClose),this.titleBar.querySelector(`.${o.minimize}`).addEventListener("click",this.handleMinimize),this.titleBar.querySelector(`.${o.maximize}`).addEventListener("click",this.handleChangeMaximize),this.body.appendChild(this.titleBar)}createForceEvent(){const t=this.body.querySelector("iframe");t?.addEventListener("load",()=>{t?.contentWindow?.document.addEventListener("pointerdown",this.focus)}),this.body.addEventListener("pointerdown",this.focus,{capture:!0})}destroy(){this._isValid=!1,this.body.querySelector("iframe")?.contentWindow?.document.removeEventListener("click",this.focus),this.body.removeEventListener("pointerdown",this.focus,{capture:!0}),this.content.remove(),this.emit(w.EventType.ON_CLOSE)}handleMaximize=()=>{this.isMaximized=!0,this.prevX=this.x,this.prevY=this.y,this.prevWidth=this.width,this.prevHeight=this.height;const{innerWidth:t,innerHeight:e}=window;this.move(0,0),this.resize(t,e)};handleRestore=()=>{this.isMaximized=!1,this.move(this.prevX,this.prevY),this.resize(this.prevWidth,this.prevHeight)};handleMinimize=()=>{this.isMinimized=!this.isMinimized,this.body.style.display=this.isMinimized?"none":"flex",this.isMinimized&&this.focus()};handleClose=()=>{s.ins.closeWindow(this)};focus=()=>{const t=s.ins.getNextZIndex();this.body.style.zIndex=String(t)};move=(t,e)=>{this.x=t,this.y=e,this.body.style.transform=`translate(${t}px, ${e}px)`};resize=(t,e)=>{this.width=t,this.height=e,this.body.style.width=`${t}px`,this.body.style.height=`${e}px`};handleReadyMove=t=>{t.stopPropagation(),document.body.style.userSelect="none",this.titleBar.style.cursor="grabbing";const e=t.clientX-this.x,d=t.clientY-this.y,a=n=>{s.ins.enableMask=!0;const r=n.clientX-e,c=n.clientY-d;this.move(r,c)},i=()=>{s.ins.enableMask=!1,document.body.style.userSelect="",this.titleBar.style.cursor="grab",document.removeEventListener("pointermove",a),document.removeEventListener("pointerup",i)};document.addEventListener("pointermove",a),document.addEventListener("pointerup",i)};handleResizeStart=(t,e)=>{t.stopPropagation(),document.body.style.userSelect="none";const d=t.clientX,a=t.clientY,i=this.x,n=this.y,r=this.width,c=this.height,y=_=>{s.ins.enableMask=!0;const f=_.clientX-d,x=_.clientY-a;if(e.includes("e")&&(this.width=Math.max(200,r+f)),e.includes("w")){const m=(this.width=Math.max(200,r-f))-r;this.x=i-m}if(e.includes("s")&&(this.height=Math.max(200,c+x)),e.includes("n")){const l=Math.max(200,c-x);this.height=l;const m=l-c;this.y=n-m}this.move(this.x,this.y),this.resize(this.width,this.height)},v=()=>{s.ins.enableMask=!1,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",v),document.body.style.userSelect=""};document.addEventListener("mousemove",y),document.addEventListener("mouseup",v)};handleChangeMaximize=()=>{this.isMaximized?this.handleRestore():this.handleMaximize()}}class F extends p{static icon;static name;static id;exited=!1;windows=new Map;onExit(){}exit(){this.exited||(this.exited=!0,this.onExit(),this.windows.forEach(t=>{t.isValid&&s.ins.closeWindow(t)}),this.windows.clear())}}export{F as V,s as W,w as a};
